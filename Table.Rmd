---
title: "Tables"
author: "MSSP Team 1"
date: "2022-11-18"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load the package

```{r,warning=FALSE}
library(tidyverse)
library(magrittr)
library(ggplot2)
library(knitr)
library(scales)
```

## Read the Data Set and filter children under 5

```{r}
health_all <- read.csv("2019-2020 NSCH_Topical_CAHMI_DRC_v1.2.csv")
health <- health_all %>% filter(SC_AGE_YEARS <= 5)

```

## EDA for independent variable: park_1920

```{r}
# EDA for park amenties.

num_with_park <- sum(health$park_1920 == "1")
num_without_park  <- sum(health$park_1920 == "2")
num_missing_park <- sum(health$park_1920 == "99")

park_ornot <- data.frame(
  group = c("YES", "NO", "MISSING"),
  count = c(num_with_park, num_without_park, num_missing_park)
  )
park_ornot

# calculate the percentage:
per_park <- park_ornot$count / sum(park_ornot$count)
per_park <- label_percent()(per_park)

park_ornot1 <- park_ornot %>%
  mutate(park_ornot, percentage = c(per_park))

kable(park_ornot1,caption = "Percentage Sumary")
```

## Read the Data Set and filter children under 5

```{r}
#read and import the csv file
NSCH_ALL <- read.csv("2019-2020 NSCH_Topical_CAHMI_DRC_v1.2.csv")
#subset to only have children no above age of 5
NSCH <- NSCH_ALL %>% filter(SC_AGE_YEARS <= 5)
```

## function

The function single_table(input) returns a tibble includes:

"Code_index": which is the coding Substitute value, typically: "1" refers to "YES", "2" refers to "NO", "99" refers to "Missing" and "95" refers to "No Answer";

"Counts": the absolute value of number of counts; "Proportion": represents the proportion of this response category in the overall sample; "Percentage": Proportional response into percentage.

This is a reusable function that can be used to obtain a summary table of all factors by entering different vectors.

The format of the input is as follows:

NSCH\$[Variable labels]

[Variable labels] can be found on the Variable labels EXcel Form; and some of the Variables that we are most interesd is listed below:

SC_AGE_YEARS \~ Age of Selected Child - In Years SC_SEX \~ Sex of Selected Child SC_RACE_R \~ Race of Selected Child, Detailed SC_HISPANIC_R \~ Hispanic Origin of Selected Child, Recode SC_CSHCN \~ Special Health Care Needs Status of Selected Child HIGRADE \~ Highest Level of Education among Reported Adults sex_1920 \~ Sex of child hispanic_1920 \~ Hispanic origin of the child PrntNativity_1920 \~ Generational status of the parents HHLanguage_1920 \~ Primary language spoken in the household povlev4_1920 \~ Income based on federal poverty level status BornUSA_1920 \~ Children who were born in the United States NbhdSupp_1920 \~ Indicator 7.1: Children who live in supportive neighborhood NbhdSafe_1920 \~ Indicator 7.2: Children live in safe neighborhoods park_1920 \~ Children who live in neighborhoods with a park or playground RecCentr_1920 \~ Children who live in neighborhoods with recreation center, community center or boys' and girls' club library_1920 \~ Children who live in neighborhoods with a library or bookmobile NbhdAmenities_1920 \~ Indicator 7.4: Count of amenities in children's neighborhoods

K4Q27 \~ Needed Health Care Not Received K5Q10 \~ Need a Referral DevScrnng_1920 \~ Indicator 4.10: Children who received a developmental screening using a parent-completed screening tool, age 9-35 months

```{r}
#this function RETURN A tibble 
single_table <- function(Code_index){
  mt <- tibble(Code_index)
  
  ans <- mt %>% 
    count(Code_index) %>%
    arrange() %>% 
    mutate(Proportion = n / sum(n)) 

  w <- ans$Proportion
  Percentage <- label_percent()(w)
  ans$Percentage <- Percentage
  colnames(ans)[2] <- "Counts"

  return(ans)
}

```

# Needed Health Care Not Received - K4Q27

# Independent Variables
```{r}
Answer<- c("YES", "NO" , "MISSING")
kable(cbind(single_table(NSCH$SC_AGE_YEARS),Answer),caption = "Age of Selected Child - In Years")
```


```{r}

Answer<- c("YES", "NO" , "MISSING")
kable(cbind(single_table(NSCH$SC_RACE_R),Answer),caption = "Race of Selected Child, Detailed")

```

```{r}
Answer<- c("YES", "NO" , "MISSING")
kable(cbind(single_table(NSCH$HHLanguage_1920),Answer),caption = "Primary language spoken in the household")
```
```{r}
Answer<- c("YES", "NO" , "MISSING")
kable(cbind(single_table(NSCH$BornUSA_1920),Answer),caption = "Children who were born in the United States")
```


```{r}
Answer<- c("YES", "NO" , "MISSING")
kable(cbind(single_table(NSCH$NbhdSupp_1920),Answer),caption = "Indicator 7.1: Children who live in supportive neighborhood")
```

```{r}
Answer<- c("YES", "NO" , "MISSING")
kable(cbind(single_table(NSCH$park_1920),Answer),caption = "Children who live in neighborhoods with a park or playground")
```

```{r}
Answer<- c("YES", "NO" , "MISSING")
kable(cbind(single_table(NSCH$RecCentr_1920),Answer),caption = "Children who live in neighborhoods with recreation center, community center or boys’ and girls’ club")
```

```{r}
Answer<- c("YES", "NO" , "MISSING")
kable(cbind(single_table(NSCH$library_1920),Answer),caption = "Children who live in neighborhoods with a library or bookmobile")
```


```{r}
Answer<- c("YES", "NO" , "MISSING")
kable(cbind(single_table(NSCH$NbhdAmenities_1920),Answer),caption = "Indicator 7.4: Count of amenities in children's neighborhoods")
```

```{r}
Answer<- c("YES", "NO" , "MISSING")
kable(cbind(single_table(NSCH$SC_AGE_YEARS),Answer),caption = "Age of Selected Child - In Years")
```


# Outcome Variable
```{r}
Answer<- c("YES", "NO" , "MISSING")
kable(cbind(single_table(NSCH$K4Q27),Answer),caption = "Needed Health Care Not Received")
```

```{r}
Answer<- c("YES", "NO" , "MISSING")
kable(cbind(single_table(NSCH$K5Q10),Answer),caption = "Need a Referral")
```


















































